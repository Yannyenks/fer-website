DirectoryIndex index.html

# 0️⃣ Bloquer l'accès aux fichiers sensibles (sauf dans /api/)
<FilesMatch "\.(sql|sh|ps1)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
</FilesMatch>

# Bloquer les fichiers .env
<FilesMatch "^\.env">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
</FilesMatch>

# Bloquer l'accès aux dossiers sensibles (sauf /api/)
RedirectMatch 403 ^/(server|scripts|storage)(/.*)?$

<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # 1️⃣ Router API vers le contrôleur PHP
    RewriteRule ^api/(.*)$ api/index.php?path=$1 [L,QSA]

    # 2️⃣ Servir directement les fichiers existants (fichiers et dossiers)
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]

    # 3️⃣ Fallback React SPA
    RewriteRule ^(.*)$ index.html [L]
</IfModule>